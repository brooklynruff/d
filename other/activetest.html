<!DOCTYPE html>
<html>
<head>
  <title>Currently Active Demo</title>
  <style type="text/css">
    .currently-active {
      position: fixed;
      margin: 10px;
      padding: 5px;
      bottom: 0;
      left: 0;
      border: solid 1px #AFAFAF;
      border-radius: 6px;
      font-family: "Arial";
    }
  </style>
</head>
<body onload="hereNow()">
  <div class="currently-active">
    <span>Currently Active: </span><span id="active"></span>
    <span id="ip"></span>
  </div>
</body>
<script src="https://cdn.pubnub.com/sdk/javascript/pubnub.8.2.10.js"></script>
<script type="text/javascript">
var active = document.getElementById('active');
function setCurrentlyActiveUsers(numberOfUsers) {
  active.innerText = numberOfUsers.toString();
}
var pubnub = new PubNub({
    publishKey : 'pub-c-5ef875b1-3cbf-4cdc-8438-28adf95db127',
    subscribeKey : 'sub-c-1a01049a-6cb2-4d11-94c1-4388a0e94565',
    userId: '' + Math.floor(Math.random() * 10000)
});
pubnub.addListener({
  presence: function(presenceEvent) {
    setCurrentlyActiveUsers(presenceEvent.occupancy);
  }
});
pubnub.subscribe({ 
  channels: ['myWebPage1'],
  withPresence: true
});

async function hereNow()
{
    const here = await pubnub.hereNow({
        channels: ['myWebPage1']
    })
    setCurrentlyActiveUsers(here.totalOccupancy)
}
</script>
</html>